{"ast":null,"code":"'use strict';\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator['throw'](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    'throw': verb(1),\n    'return': verb(2)\n  }, typeof Symbol === 'function' && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError('Generator is already executing.');\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y['return'] : op[0] ? y['throw'] || ((t = y['return']) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    'default': mod\n  };\n};\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.CoinGeckoDataService = exports.ETH_CURRENCY_CODE = exports.USD_CURRENCY_CODE = void 0;\n\nvar pageResults = require('graph-results-pager');\n\nvar axios_1 = __importDefault(require('axios'));\n\nvar assertions_1 = __importDefault(require('../../assertions'));\n\nexports.USD_CURRENCY_CODE = 'usd';\nexports.ETH_CURRENCY_CODE = 'eth';\n\nvar CoinGeckoDataService = function () {\n  function CoinGeckoDataService(chainId) {\n    this.assert = new assertions_1.default();\n    this.assert.common.isSupportedChainId(chainId);\n    this.chainId = chainId;\n  }\n\n  CoinGeckoDataService.prototype.fetchCoinPrices = function (params) {\n    return __awaiter(this, void 0, void 0, function () {\n      var platform, endpoint, contractAddressParams, vsCurrenciesParams, url, response, e_1, _i, _a, address;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            platform = this.getPlatform();\n            endpoint = 'https://api.coingecko.com/api/v3/simple/token_price/' + platform + '?';\n            contractAddressParams = 'contract_addresses=' + params.contractAddresses.join(',');\n            vsCurrenciesParams = 'vs_currencies=' + params.vsCurrencies.join(',');\n            url = '' + endpoint + contractAddressParams + '&' + vsCurrenciesParams;\n            _b.label = 1;\n\n          case 1:\n            _b.trys.push([1, 3,, 4]);\n\n            return [4, axios_1.default.get(url)];\n\n          case 2:\n            response = _b.sent();\n            return [3, 4];\n\n          case 3:\n            e_1 = _b.sent();\n            response = {\n              data: {}\n            };\n\n            for (_i = 0, _a = params.contractAddresses; _i < _a.length; _i++) {\n              address = _a[_i];\n              response.data[address] = {};\n              response.data[address][params.vsCurrencies[0]] = 0;\n            }\n\n            return [3, 4];\n\n          case 4:\n            return [2, response.data];\n        }\n      });\n    });\n  };\n\n  CoinGeckoDataService.prototype.fetchTokenList = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, _b, _c;\n\n      return __generator(this, function (_d) {\n        switch (_d.label) {\n          case 0:\n            if (this.tokenList !== undefined) return [2, this.tokenList];\n            _a = this.chainId;\n\n            switch (_a) {\n              case 1:\n                return [3, 1];\n\n              case 137:\n                return [3, 3];\n            }\n\n            return [3, 5];\n\n          case 1:\n            _b = this;\n            return [4, this.fetchEthereumTokenList()];\n\n          case 2:\n            _b.tokenList = _d.sent();\n            return [3, 5];\n\n          case 3:\n            _c = this;\n            return [4, this.fetchPolygonTokenList()];\n\n          case 4:\n            _c.tokenList = _d.sent();\n            return [3, 5];\n\n          case 5:\n            this.tokenMap = this.convertTokenListToAddressMap(this.tokenList);\n            return [2, this.tokenList];\n        }\n      });\n    });\n  };\n\n  CoinGeckoDataService.prototype.fetchTokenMap = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a;\n\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (this.tokenMap !== undefined) return [2, this.tokenMap];\n            _a = this;\n            return [4, this.fetchTokenList()];\n\n          case 1:\n            _a.tokenList = _b.sent();\n            this.tokenMap = this.convertTokenListToAddressMap(this.tokenList);\n            return [2, this.tokenMap];\n        }\n      });\n    });\n  };\n\n  CoinGeckoDataService.prototype.convertTokenListToAddressMap = function (list) {\n    if (list === void 0) {\n      list = [];\n    }\n\n    var tokenMap = {};\n\n    for (var _i = 0, list_1 = list; _i < list_1.length; _i++) {\n      var entry = list_1[_i];\n      tokenMap[entry.address] = Object.assign({}, entry);\n    }\n\n    return tokenMap;\n  };\n\n  CoinGeckoDataService.prototype.getPlatform = function () {\n    switch (this.chainId) {\n      case 1:\n        return 'ethereum';\n\n      case 137:\n        return 'polygon-pos';\n\n      default:\n        return '';\n    }\n  };\n\n  CoinGeckoDataService.prototype.fetchEthereumTokenList = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var url, response;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            url = 'https://tokens.coingecko.com/uniswap/all.json';\n            return [4, axios_1.default.get(url)];\n\n          case 1:\n            response = _a.sent();\n            return [2, response.data.tokens];\n        }\n      });\n    });\n  };\n\n  CoinGeckoDataService.prototype.fetchPolygonTokenList = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var coingeckoEthereumTokens, polygonMappedTokens, sushiPolygonTokenList, quickswapPolygonTokenList, _loop_1, _i, sushiPolygonTokenList_1, token;\n\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4, this.fetchEthereumTokenList()];\n\n          case 1:\n            coingeckoEthereumTokens = _a.sent();\n            return [4, this.fetchPolygonMappedTokenList()];\n\n          case 2:\n            polygonMappedTokens = _a.sent();\n            return [4, this.fetchSushiPolygonTokenList()];\n\n          case 3:\n            sushiPolygonTokenList = _a.sent();\n            return [4, this.fetchQuickswapPolygonTokenList()];\n\n          case 4:\n            quickswapPolygonTokenList = _a.sent();\n\n            _loop_1 = function (token) {\n              var quickswapToken = quickswapPolygonTokenList.find(function (t) {\n                return t.address.toLowerCase() === token.address;\n              });\n\n              if (quickswapToken) {\n                token.logoURI = quickswapToken.logoURI;\n                return 'continue';\n              }\n\n              var ethereumAddress = polygonMappedTokens[token.address];\n\n              if (ethereumAddress !== undefined) {\n                var ethereumToken = coingeckoEthereumTokens.find(function (t) {\n                  return t.address.toLowerCase() === ethereumAddress;\n                });\n\n                if (ethereumToken) {\n                  token.logoURI = ethereumToken.logoURI;\n                }\n              }\n            };\n\n            for (_i = 0, sushiPolygonTokenList_1 = sushiPolygonTokenList; _i < sushiPolygonTokenList_1.length; _i++) {\n              token = sushiPolygonTokenList_1[_i];\n\n              _loop_1(token);\n            }\n\n            return [2, sushiPolygonTokenList];\n        }\n      });\n    });\n  };\n\n  CoinGeckoDataService.prototype.fetchSushiPolygonTokenList = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var tokens, url, properties, response, _i, response_1, token;\n\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            tokens = [];\n            url = 'https://api.thegraph.com/subgraphs/name/sushiswap/matic-exchange';\n            properties = ['id', 'symbol', 'name', 'decimals', 'volumeUSD'];\n            return [4, pageResults({\n              api: url,\n              query: {\n                entity: 'tokens',\n                properties: properties\n              }\n            })];\n\n          case 1:\n            response = _a.sent();\n\n            for (_i = 0, response_1 = response; _i < response_1.length; _i++) {\n              token = response_1[_i];\n              tokens.push({\n                chainId: 137,\n                address: token.id,\n                symbol: token.symbol,\n                name: token.name,\n                decimals: parseInt(token.decimals),\n                volumeUSD: parseFloat(token.volumeUSD)\n              });\n            }\n\n            tokens.sort(function (a, b) {\n              return b.volumeUSD - a.volumeUSD;\n            });\n            tokens = tokens.filter(function (t) {\n              return t.volumeUSD > 0;\n            });\n            return [2, tokens];\n        }\n      });\n    });\n  };\n\n  CoinGeckoDataService.prototype.fetchPolygonMappedTokenList = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var tokens, url, properties, response, _i, response_2, tokenMapping;\n\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            tokens = {};\n            url = 'https://api.thegraph.com/subgraphs/name/maticnetwork/mainnet-root-subgraphs';\n            properties = ['id', 'rootToken', 'childToken'];\n            return [4, pageResults({\n              api: url,\n              query: {\n                entity: 'tokenMappings',\n                properties: properties\n              }\n            })];\n\n          case 1:\n            response = _a.sent();\n\n            for (_i = 0, response_2 = response; _i < response_2.length; _i++) {\n              tokenMapping = response_2[_i];\n              tokens[tokenMapping.childToken.toLowerCase()] = tokenMapping.rootToken.toLowerCase();\n            }\n\n            return [2, tokens];\n        }\n      });\n    });\n  };\n\n  CoinGeckoDataService.prototype.fetchQuickswapPolygonTokenList = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var url, data;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            url = 'https://raw.githubusercontent.com/sameepsi/' + 'quickswap-default-token-list/master/src/tokens/mainnet.json';\n            return [4, axios_1.default.get(url)];\n\n          case 1:\n            data = _a.sent().data;\n            return [2, data];\n        }\n      });\n    });\n  };\n\n  return CoinGeckoDataService;\n}();\n\nexports.CoinGeckoDataService = CoinGeckoDataService;","map":{"version":3,"sources":["/Users/safahi/Documents/GitHub/appwebsite/node_modules/set.js/dist/src/api/utils/coingecko.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","__importDefault","mod","__esModule","Object","defineProperty","exports","CoinGeckoDataService","ETH_CURRENCY_CODE","USD_CURRENCY_CODE","pageResults","require","axios_1","assertions_1","chainId","assert","default","common","isSupportedChainId","prototype","fetchCoinPrices","params","platform","endpoint","contractAddressParams","vsCurrenciesParams","url","response","e_1","_i","_a","address","_b","getPlatform","contractAddresses","join","vsCurrencies","get","data","fetchTokenList","_c","_d","tokenList","undefined","fetchEthereumTokenList","fetchPolygonTokenList","tokenMap","convertTokenListToAddressMap","fetchTokenMap","list","list_1","entry","assign","tokens","coingeckoEthereumTokens","polygonMappedTokens","sushiPolygonTokenList","quickswapPolygonTokenList","_loop_1","sushiPolygonTokenList_1","token","fetchPolygonMappedTokenList","fetchSushiPolygonTokenList","fetchQuickswapPolygonTokenList","quickswapToken","find","toLowerCase","logoURI","ethereumAddress","ethereumToken","properties","response_1","api","query","entity","id","symbol","name","decimals","parseInt","volumeUSD","parseFloat","sort","a","b","filter","response_2","tokenMapping","childToken","rootToken"],"mappings":"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","sourcesContent":["'use strict';var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value);});}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value));}catch(e){reject(e);}}function rejected(value){try{step(generator['throw'](value));}catch(e){reject(e);}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected);}step((generator=generator.apply(thisArg,_arguments||[])).next());});};var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1];},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),'throw':verb(1),'return':verb(2)},typeof Symbol==='function'&&(g[Symbol.iterator]=function(){return this;}),g;function verb(n){return function(v){return step([n,v]);};}function step(op){if(f)throw new TypeError('Generator is already executing.');while(_)try{if(f=1,y&&(t=op[0]&2?y['return']:op[0]?y['throw']||((t=y['return'])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue;}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break;}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break;}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break;}if(t[2])_.ops.pop();_.trys.pop();continue;}op=body.call(thisArg,_);}catch(e){op=[6,e];y=0;}finally{f=t=0;}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true};}};var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{'default':mod};};Object.defineProperty(exports,'__esModule',{value:true});exports.CoinGeckoDataService=exports.ETH_CURRENCY_CODE=exports.USD_CURRENCY_CODE=void 0;var pageResults=require('graph-results-pager');var axios_1=__importDefault(require('axios'));var assertions_1=__importDefault(require('../../assertions'));exports.USD_CURRENCY_CODE='usd';exports.ETH_CURRENCY_CODE='eth';var CoinGeckoDataService=function(){function CoinGeckoDataService(chainId){this.assert=new assertions_1.default();this.assert.common.isSupportedChainId(chainId);this.chainId=chainId;}CoinGeckoDataService.prototype.fetchCoinPrices=function(params){return __awaiter(this,void 0,void 0,function(){var platform,endpoint,contractAddressParams,vsCurrenciesParams,url,response,e_1,_i,_a,address;return __generator(this,function(_b){switch(_b.label){case 0:platform=this.getPlatform();endpoint='https://api.coingecko.com/api/v3/simple/token_price/'+platform+'?';contractAddressParams='contract_addresses='+params.contractAddresses.join(',');vsCurrenciesParams='vs_currencies='+params.vsCurrencies.join(',');url=''+endpoint+contractAddressParams+'&'+vsCurrenciesParams;_b.label=1;case 1:_b.trys.push([1,3,,4]);return[4,axios_1.default.get(url)];case 2:response=_b.sent();return[3,4];case 3:e_1=_b.sent();response={data:{}};for(_i=0,_a=params.contractAddresses;_i<_a.length;_i++){address=_a[_i];response.data[address]={};response.data[address][params.vsCurrencies[0]]=0;}return[3,4];case 4:return[2,response.data];}});});};CoinGeckoDataService.prototype.fetchTokenList=function(){return __awaiter(this,void 0,void 0,function(){var _a,_b,_c;return __generator(this,function(_d){switch(_d.label){case 0:if(this.tokenList!==undefined)return[2,this.tokenList];_a=this.chainId;switch(_a){case 1:return[3,1];case 137:return[3,3];}return[3,5];case 1:_b=this;return[4,this.fetchEthereumTokenList()];case 2:_b.tokenList=_d.sent();return[3,5];case 3:_c=this;return[4,this.fetchPolygonTokenList()];case 4:_c.tokenList=_d.sent();return[3,5];case 5:this.tokenMap=this.convertTokenListToAddressMap(this.tokenList);return[2,this.tokenList];}});});};CoinGeckoDataService.prototype.fetchTokenMap=function(){return __awaiter(this,void 0,void 0,function(){var _a;return __generator(this,function(_b){switch(_b.label){case 0:if(this.tokenMap!==undefined)return[2,this.tokenMap];_a=this;return[4,this.fetchTokenList()];case 1:_a.tokenList=_b.sent();this.tokenMap=this.convertTokenListToAddressMap(this.tokenList);return[2,this.tokenMap];}});});};CoinGeckoDataService.prototype.convertTokenListToAddressMap=function(list){if(list===void 0){list=[];}var tokenMap={};for(var _i=0,list_1=list;_i<list_1.length;_i++){var entry=list_1[_i];tokenMap[entry.address]=Object.assign({},entry);}return tokenMap;};CoinGeckoDataService.prototype.getPlatform=function(){switch(this.chainId){case 1:return'ethereum';case 137:return'polygon-pos';default:return'';}};CoinGeckoDataService.prototype.fetchEthereumTokenList=function(){return __awaiter(this,void 0,void 0,function(){var url,response;return __generator(this,function(_a){switch(_a.label){case 0:url='https://tokens.coingecko.com/uniswap/all.json';return[4,axios_1.default.get(url)];case 1:response=_a.sent();return[2,response.data.tokens];}});});};CoinGeckoDataService.prototype.fetchPolygonTokenList=function(){return __awaiter(this,void 0,void 0,function(){var coingeckoEthereumTokens,polygonMappedTokens,sushiPolygonTokenList,quickswapPolygonTokenList,_loop_1,_i,sushiPolygonTokenList_1,token;return __generator(this,function(_a){switch(_a.label){case 0:return[4,this.fetchEthereumTokenList()];case 1:coingeckoEthereumTokens=_a.sent();return[4,this.fetchPolygonMappedTokenList()];case 2:polygonMappedTokens=_a.sent();return[4,this.fetchSushiPolygonTokenList()];case 3:sushiPolygonTokenList=_a.sent();return[4,this.fetchQuickswapPolygonTokenList()];case 4:quickswapPolygonTokenList=_a.sent();_loop_1=function(token){var quickswapToken=quickswapPolygonTokenList.find(function(t){return t.address.toLowerCase()===token.address;});if(quickswapToken){token.logoURI=quickswapToken.logoURI;return'continue';}var ethereumAddress=polygonMappedTokens[token.address];if(ethereumAddress!==undefined){var ethereumToken=coingeckoEthereumTokens.find(function(t){return t.address.toLowerCase()===ethereumAddress;});if(ethereumToken){token.logoURI=ethereumToken.logoURI;}}};for(_i=0,sushiPolygonTokenList_1=sushiPolygonTokenList;_i<sushiPolygonTokenList_1.length;_i++){token=sushiPolygonTokenList_1[_i];_loop_1(token);}return[2,sushiPolygonTokenList];}});});};CoinGeckoDataService.prototype.fetchSushiPolygonTokenList=function(){return __awaiter(this,void 0,void 0,function(){var tokens,url,properties,response,_i,response_1,token;return __generator(this,function(_a){switch(_a.label){case 0:tokens=[];url='https://api.thegraph.com/subgraphs/name/sushiswap/matic-exchange';properties=['id','symbol','name','decimals','volumeUSD'];return[4,pageResults({api:url,query:{entity:'tokens',properties:properties}})];case 1:response=_a.sent();for(_i=0,response_1=response;_i<response_1.length;_i++){token=response_1[_i];tokens.push({chainId:137,address:token.id,symbol:token.symbol,name:token.name,decimals:parseInt(token.decimals),volumeUSD:parseFloat(token.volumeUSD)});}tokens.sort(function(a,b){return b.volumeUSD-a.volumeUSD;});tokens=tokens.filter(function(t){return t.volumeUSD>0;});return[2,tokens];}});});};CoinGeckoDataService.prototype.fetchPolygonMappedTokenList=function(){return __awaiter(this,void 0,void 0,function(){var tokens,url,properties,response,_i,response_2,tokenMapping;return __generator(this,function(_a){switch(_a.label){case 0:tokens={};url='https://api.thegraph.com/subgraphs/name/maticnetwork/mainnet-root-subgraphs';properties=['id','rootToken','childToken'];return[4,pageResults({api:url,query:{entity:'tokenMappings',properties:properties}})];case 1:response=_a.sent();for(_i=0,response_2=response;_i<response_2.length;_i++){tokenMapping=response_2[_i];tokens[tokenMapping.childToken.toLowerCase()]=tokenMapping.rootToken.toLowerCase();}return[2,tokens];}});});};CoinGeckoDataService.prototype.fetchQuickswapPolygonTokenList=function(){return __awaiter(this,void 0,void 0,function(){var url,data;return __generator(this,function(_a){switch(_a.label){case 0:url='https://raw.githubusercontent.com/sameepsi/'+'quickswap-default-token-list/master/src/tokens/mainnet.json';return[4,axios_1.default.get(url)];case 1:data=_a.sent().data;return[2,data];}});});};return CoinGeckoDataService;}();exports.CoinGeckoDataService=CoinGeckoDataService;"]},"metadata":{},"sourceType":"script"}