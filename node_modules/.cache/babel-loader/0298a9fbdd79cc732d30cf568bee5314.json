{"ast":null,"code":"import Web3 from 'web3';\nimport { mviStakingRewardsAddress } from 'constants/ethContractAddresses';\nimport StakeABI from 'index-sdk/abi/Stake.json';\nimport BigNumber from 'utils/bignumber';\nexport const getStakingRewardsContract = provider => {\n  const web3 = new Web3(provider);\n  const contract = new web3.eth.Contract(StakeABI, mviStakingRewardsAddress);\n  return contract;\n};\nexport const stakeUniswapEthMviLpTokens = (provider, account, stakeQuantity) => {\n  const stakingContract = getStakingRewardsContract(provider);\n  return new Promise(resolve => {\n    stakingContract.methods.stake(stakeQuantity.toString()).send({\n      from: account,\n      gas: 200000\n    }).on('transactionHash', txId => {\n      if (!txId) resolve(null);\n      resolve(txId);\n    }).on('error', error => {\n      console.log(error);\n      resolve(null);\n    });\n  });\n};\nexport const unstakeUniswapEthMviLpTokens = (provider, account, unstakeQuantity) => {\n  const stakingContract = getStakingRewardsContract(provider);\n  return new Promise(resolve => {\n    stakingContract.methods.withdraw(unstakeQuantity.toString()).send({\n      from: account,\n      gas: 200000\n    }).on('transactionHash', txId => {\n      if (!txId) resolve(null);\n      resolve(txId);\n    }).on('error', error => {\n      console.log(error);\n      resolve(null);\n    });\n  });\n};\nexport const getEarnedIndexTokenQuantity = async (provider, account) => {\n  const stakingContract = getStakingRewardsContract(provider);\n\n  try {\n    const earnedTokenQuantity = stakingContract.methods.earned(account).call();\n    return new BigNumber(earnedTokenQuantity);\n  } catch (e) {\n    console.log(e);\n    return new BigNumber(0);\n  }\n};\nexport const claimEarnedIndexLpReward = (provider, account) => {\n  const stakingContract = getStakingRewardsContract(provider);\n  return new Promise(resolve => {\n    stakingContract.methods.getReward().send({\n      from: account,\n      gas: 200000\n    }).on('transactionHash', txId => {\n      if (!txId) resolve(null);\n      resolve(txId);\n    }).on('error', error => {\n      console.log(error);\n      resolve(null);\n    });\n  });\n};\nexport const unstakeAndClaimEarnedIndexLpReward = (provider, account) => {\n  const stakingContract = getStakingRewardsContract(provider);\n  return new Promise(resolve => {\n    stakingContract.methods.exit().send({\n      from: account,\n      gas: 250000\n    }).on('transactionHash', txId => {\n      if (!txId) resolve(null);\n      resolve(txId);\n    }).on('error', error => {\n      console.log(error);\n      resolve(null);\n    });\n  });\n}; // Currently set for 12pm PST Apr. 8th 2021\n\nexport const mviStakingRewardsStartTime = '1617908400000';","map":{"version":3,"sources":["/Users/safahi/Documents/GitHub/appwebsite/src/index-sdk/mviStaking.ts"],"names":["Web3","mviStakingRewardsAddress","StakeABI","BigNumber","getStakingRewardsContract","provider","web3","contract","eth","Contract","stakeUniswapEthMviLpTokens","account","stakeQuantity","stakingContract","Promise","resolve","methods","stake","toString","send","from","gas","on","txId","error","console","log","unstakeUniswapEthMviLpTokens","unstakeQuantity","withdraw","getEarnedIndexTokenQuantity","earnedTokenQuantity","earned","call","e","claimEarnedIndexLpReward","getReward","unstakeAndClaimEarnedIndexLpReward","exit","mviStakingRewardsStartTime"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,MAAjB;AAIA,SAASC,wBAAT,QAAyC,gCAAzC;AACA,OAAOC,QAAP,MAAqB,0BAArB;AACA,OAAOC,SAAP,MAAsB,iBAAtB;AAEA,OAAO,MAAMC,yBAAyB,GAAIC,QAAD,IAAwB;AAC/D,QAAMC,IAAI,GAAG,IAAIN,IAAJ,CAASK,QAAT,CAAb;AACA,QAAME,QAAQ,GAAG,IAAID,IAAI,CAACE,GAAL,CAASC,QAAb,CACfP,QADe,EAEfD,wBAFe,CAAjB;AAIA,SAAOM,QAAP;AACD,CAPM;AASP,OAAO,MAAMG,0BAA0B,GAAG,CACxCL,QADwC,EAExCM,OAFwC,EAGxCC,aAHwC,KAIb;AAC3B,QAAMC,eAAe,GAAGT,yBAAyB,CAACC,QAAD,CAAjD;AAEA,SAAO,IAAIS,OAAJ,CAAaC,OAAD,IAAa;AAC9BF,IAAAA,eAAe,CAACG,OAAhB,CACGC,KADH,CACSL,aAAa,CAACM,QAAd,EADT,EAEGC,IAFH,CAEQ;AAAEC,MAAAA,IAAI,EAAET,OAAR;AAAiBU,MAAAA,GAAG,EAAE;AAAtB,KAFR,EAGGC,EAHH,CAGM,iBAHN,EAG0BC,IAAD,IAAkB;AACvC,UAAI,CAACA,IAAL,EAAWR,OAAO,CAAC,IAAD,CAAP;AAEXA,MAAAA,OAAO,CAACQ,IAAD,CAAP;AACD,KAPH,EAQGD,EARH,CAQM,OARN,EAQgBE,KAAD,IAAgB;AAC3BC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACAT,MAAAA,OAAO,CAAC,IAAD,CAAP;AACD,KAXH;AAYD,GAbM,CAAP;AAcD,CArBM;AAuBP,OAAO,MAAMY,4BAA4B,GAAG,CAC1CtB,QAD0C,EAE1CM,OAF0C,EAG1CiB,eAH0C,KAIf;AAC3B,QAAMf,eAAe,GAAGT,yBAAyB,CAACC,QAAD,CAAjD;AAEA,SAAO,IAAIS,OAAJ,CAAaC,OAAD,IAAa;AAC9BF,IAAAA,eAAe,CAACG,OAAhB,CACGa,QADH,CACYD,eAAe,CAACV,QAAhB,EADZ,EAEGC,IAFH,CAEQ;AAAEC,MAAAA,IAAI,EAAET,OAAR;AAAiBU,MAAAA,GAAG,EAAE;AAAtB,KAFR,EAGGC,EAHH,CAGM,iBAHN,EAG0BC,IAAD,IAAkB;AACvC,UAAI,CAACA,IAAL,EAAWR,OAAO,CAAC,IAAD,CAAP;AAEXA,MAAAA,OAAO,CAACQ,IAAD,CAAP;AACD,KAPH,EAQGD,EARH,CAQM,OARN,EAQgBE,KAAD,IAAgB;AAC3BC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACAT,MAAAA,OAAO,CAAC,IAAD,CAAP;AACD,KAXH;AAYD,GAbM,CAAP;AAcD,CArBM;AAuBP,OAAO,MAAMe,2BAA2B,GAAG,OACzCzB,QADyC,EAEzCM,OAFyC,KAGlB;AACvB,QAAME,eAAe,GAAGT,yBAAyB,CAACC,QAAD,CAAjD;;AAEA,MAAI;AACF,UAAM0B,mBAAmB,GAAGlB,eAAe,CAACG,OAAhB,CAAwBgB,MAAxB,CAA+BrB,OAA/B,EAAwCsB,IAAxC,EAA5B;AAEA,WAAO,IAAI9B,SAAJ,CAAc4B,mBAAd,CAAP;AACD,GAJD,CAIE,OAAOG,CAAP,EAAU;AACVT,IAAAA,OAAO,CAACC,GAAR,CAAYQ,CAAZ;AAEA,WAAO,IAAI/B,SAAJ,CAAc,CAAd,CAAP;AACD;AACF,CAfM;AAiBP,OAAO,MAAMgC,wBAAwB,GAAG,CACtC9B,QADsC,EAEtCM,OAFsC,KAGX;AAC3B,QAAME,eAAe,GAAGT,yBAAyB,CAACC,QAAD,CAAjD;AAEA,SAAO,IAAIS,OAAJ,CAAaC,OAAD,IAAa;AAC9BF,IAAAA,eAAe,CAACG,OAAhB,CACGoB,SADH,GAEGjB,IAFH,CAEQ;AAAEC,MAAAA,IAAI,EAAET,OAAR;AAAiBU,MAAAA,GAAG,EAAE;AAAtB,KAFR,EAGGC,EAHH,CAGM,iBAHN,EAG0BC,IAAD,IAAkB;AACvC,UAAI,CAACA,IAAL,EAAWR,OAAO,CAAC,IAAD,CAAP;AAEXA,MAAAA,OAAO,CAACQ,IAAD,CAAP;AACD,KAPH,EAQGD,EARH,CAQM,OARN,EAQgBE,KAAD,IAAgB;AAC3BC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACAT,MAAAA,OAAO,CAAC,IAAD,CAAP;AACD,KAXH;AAYD,GAbM,CAAP;AAcD,CApBM;AAsBP,OAAO,MAAMsB,kCAAkC,GAAG,CAChDhC,QADgD,EAEhDM,OAFgD,KAGrB;AAC3B,QAAME,eAAe,GAAGT,yBAAyB,CAACC,QAAD,CAAjD;AAEA,SAAO,IAAIS,OAAJ,CAAaC,OAAD,IAAa;AAC9BF,IAAAA,eAAe,CAACG,OAAhB,CACGsB,IADH,GAEGnB,IAFH,CAEQ;AAAEC,MAAAA,IAAI,EAAET,OAAR;AAAiBU,MAAAA,GAAG,EAAE;AAAtB,KAFR,EAGGC,EAHH,CAGM,iBAHN,EAG0BC,IAAD,IAAkB;AACvC,UAAI,CAACA,IAAL,EAAWR,OAAO,CAAC,IAAD,CAAP;AAEXA,MAAAA,OAAO,CAACQ,IAAD,CAAP;AACD,KAPH,EAQGD,EARH,CAQM,OARN,EAQgBE,KAAD,IAAgB;AAC3BC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACAT,MAAAA,OAAO,CAAC,IAAD,CAAP;AACD,KAXH;AAYD,GAbM,CAAP;AAcD,CApBM,C,CAsBP;;AACA,OAAO,MAAMwB,0BAA0B,GAAG,eAAnC","sourcesContent":["import Web3 from 'web3'\nimport { provider } from 'web3-core'\nimport { AbiItem } from 'web3-utils'\n\nimport { mviStakingRewardsAddress } from 'constants/ethContractAddresses'\nimport StakeABI from 'index-sdk/abi/Stake.json'\nimport BigNumber from 'utils/bignumber'\n\nexport const getStakingRewardsContract = (provider: provider) => {\n  const web3 = new Web3(provider)\n  const contract = new web3.eth.Contract(\n    StakeABI as unknown as AbiItem,\n    mviStakingRewardsAddress\n  )\n  return contract\n}\n\nexport const stakeUniswapEthMviLpTokens = (\n  provider: provider,\n  account: string,\n  stakeQuantity: BigNumber\n): Promise<string | null> => {\n  const stakingContract = getStakingRewardsContract(provider)\n\n  return new Promise((resolve) => {\n    stakingContract.methods\n      .stake(stakeQuantity.toString())\n      .send({ from: account, gas: 200000 })\n      .on('transactionHash', (txId: string) => {\n        if (!txId) resolve(null)\n\n        resolve(txId)\n      })\n      .on('error', (error: any) => {\n        console.log(error)\n        resolve(null)\n      })\n  })\n}\n\nexport const unstakeUniswapEthMviLpTokens = (\n  provider: provider,\n  account: string,\n  unstakeQuantity: BigNumber\n): Promise<string | null> => {\n  const stakingContract = getStakingRewardsContract(provider)\n\n  return new Promise((resolve) => {\n    stakingContract.methods\n      .withdraw(unstakeQuantity.toString())\n      .send({ from: account, gas: 200000 })\n      .on('transactionHash', (txId: string) => {\n        if (!txId) resolve(null)\n\n        resolve(txId)\n      })\n      .on('error', (error: any) => {\n        console.log(error)\n        resolve(null)\n      })\n  })\n}\n\nexport const getEarnedIndexTokenQuantity = async (\n  provider: provider,\n  account: string\n): Promise<BigNumber> => {\n  const stakingContract = getStakingRewardsContract(provider)\n\n  try {\n    const earnedTokenQuantity = stakingContract.methods.earned(account).call()\n\n    return new BigNumber(earnedTokenQuantity)\n  } catch (e) {\n    console.log(e)\n\n    return new BigNumber(0)\n  }\n}\n\nexport const claimEarnedIndexLpReward = (\n  provider: provider,\n  account: string\n): Promise<string | null> => {\n  const stakingContract = getStakingRewardsContract(provider)\n\n  return new Promise((resolve) => {\n    stakingContract.methods\n      .getReward()\n      .send({ from: account, gas: 200000 })\n      .on('transactionHash', (txId: string) => {\n        if (!txId) resolve(null)\n\n        resolve(txId)\n      })\n      .on('error', (error: any) => {\n        console.log(error)\n        resolve(null)\n      })\n  })\n}\n\nexport const unstakeAndClaimEarnedIndexLpReward = (\n  provider: provider,\n  account: string\n): Promise<string | null> => {\n  const stakingContract = getStakingRewardsContract(provider)\n\n  return new Promise((resolve) => {\n    stakingContract.methods\n      .exit()\n      .send({ from: account, gas: 250000 })\n      .on('transactionHash', (txId: string) => {\n        if (!txId) resolve(null)\n\n        resolve(txId)\n      })\n      .on('error', (error: any) => {\n        console.log(error)\n        resolve(null)\n      })\n  })\n}\n\n// Currently set for 12pm PST Apr. 8th 2021\nexport const mviStakingRewardsStartTime = '1617908400000'\n"]},"metadata":{},"sourceType":"module"}