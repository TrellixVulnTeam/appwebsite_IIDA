{"ast":null,"code":"import Web3 from 'web3';\nimport { gmiStakingRewardsAddress } from 'constants/ethContractAddresses';\nimport StakeABI from 'index-sdk/abi/Stake.json';\nimport BigNumber from 'utils/bignumber';\nexport const getStakingRewardsContract = provider => {\n  const web3 = new Web3(provider);\n  const contract = new web3.eth.Contract(StakeABI, gmiStakingRewardsAddress);\n  return contract;\n};\nexport const stakeGmiTokens = (provider, account, stakeQuantity) => {\n  const stakingContract = getStakingRewardsContract(provider);\n  return new Promise(resolve => {\n    stakingContract.methods.stake(stakeQuantity.toString()).send({\n      from: account,\n      gas: 200000\n    }).on('transactionHash', txId => {\n      if (!txId) resolve(null);\n      resolve(txId);\n    }).on('error', error => {\n      console.log(error);\n      resolve(null);\n    });\n  });\n};\nexport const unstakeGmiTokens = (provider, account, unstakeQuantity) => {\n  const stakingContract = getStakingRewardsContract(provider);\n  return new Promise(resolve => {\n    stakingContract.methods.withdraw(unstakeQuantity.toString()).send({\n      from: account,\n      gas: 200000\n    }).on('transactionHash', txId => {\n      if (!txId) resolve(null);\n      resolve(txId);\n    }).on('error', error => {\n      console.log(error);\n      resolve(null);\n    });\n  });\n};\nexport const getEarnedIndexTokenQuantity = async (provider, account) => {\n  const stakingContract = getStakingRewardsContract(provider);\n\n  try {\n    const earnedTokenQuantity = stakingContract.methods.earned(account).call();\n    return earnedTokenQuantity;\n  } catch (e) {\n    console.log(e);\n    return '0';\n  }\n};\nexport const claimEarnedIndexReward = (provider, account) => {\n  const stakingContract = getStakingRewardsContract(provider);\n  return new Promise(resolve => {\n    stakingContract.methods.getReward().send({\n      from: account,\n      gas: 200000\n    }).on('transactionHash', txId => {\n      if (!txId) resolve(null);\n      resolve(txId);\n    }).on('error', error => {\n      console.log(error);\n      resolve(null);\n    });\n  });\n};\nexport const unstakeAndClaimEarnedIndexReward = (provider, account) => {\n  const stakingContract = getStakingRewardsContract(provider);\n  return new Promise(resolve => {\n    stakingContract.methods.exit().send({\n      from: account,\n      gas: 250000\n    }).on('transactionHash', txId => {\n      if (!txId) resolve(null);\n      resolve(txId);\n    }).on('error', error => {\n      console.log(error);\n      resolve(null);\n    });\n  });\n};\nexport const getAmountOfStakedTokens = async (provider, contractAddress) => {\n  const web3 = new Web3(provider);\n  const contract = new web3.eth.Contract(StakeABI, contractAddress);\n  return await contract.methods.totalSupply().call();\n};\nexport const getRewardsForDuration = async provider => {\n  const stakingContract = getStakingRewardsContract(provider);\n  const rewardForDuration = await stakingContract.methods.getRewardForDuration().call();\n  return new BigNumber(rewardForDuration);\n};\nexport const getTotalSupply = async provider => {\n  const stakingContract = getStakingRewardsContract(provider);\n  const totalSupply = await stakingContract.methods.totalSupply().call();\n  return new BigNumber(totalSupply);\n}; // Currently set for 12pm PST Dec. 6th\n\nexport const farmEndTime = '1646542800';","map":{"version":3,"sources":["/Users/safahi/Desktop/index-ui-master/src/index-sdk/gmiStaking.ts"],"names":["Web3","gmiStakingRewardsAddress","StakeABI","BigNumber","getStakingRewardsContract","provider","web3","contract","eth","Contract","stakeGmiTokens","account","stakeQuantity","stakingContract","Promise","resolve","methods","stake","toString","send","from","gas","on","txId","error","console","log","unstakeGmiTokens","unstakeQuantity","withdraw","getEarnedIndexTokenQuantity","earnedTokenQuantity","earned","call","e","claimEarnedIndexReward","getReward","unstakeAndClaimEarnedIndexReward","exit","getAmountOfStakedTokens","contractAddress","totalSupply","getRewardsForDuration","rewardForDuration","getRewardForDuration","getTotalSupply","farmEndTime"],"mappings":"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","sourcesContent":["import Web3 from 'web3'\nimport { provider } from 'web3-core'\nimport { AbiItem } from 'web3-utils'\n\nimport { gmiStakingRewardsAddress } from 'constants/ethContractAddresses'\nimport StakeABI from 'index-sdk/abi/Stake.json'\nimport BigNumber from 'utils/bignumber'\n\nexport const getStakingRewardsContract = (provider: provider) => {\n  const web3 = new Web3(provider)\n  const contract = new web3.eth.Contract(\n    StakeABI as unknown as AbiItem,\n    gmiStakingRewardsAddress\n  )\n  return contract\n}\n\nexport const stakeGmiTokens = (\n  provider: provider,\n  account: string,\n  stakeQuantity: BigNumber\n): Promise<string | null> => {\n  const stakingContract = getStakingRewardsContract(provider)\n\n  return new Promise((resolve) => {\n    stakingContract.methods\n      .stake(stakeQuantity.toString())\n      .send({ from: account, gas: 200000 })\n      .on('transactionHash', (txId: string) => {\n        if (!txId) resolve(null)\n\n        resolve(txId)\n      })\n      .on('error', (error: any) => {\n        console.log(error)\n        resolve(null)\n      })\n  })\n}\n\nexport const unstakeGmiTokens = (\n  provider: provider,\n  account: string,\n  unstakeQuantity: BigNumber\n): Promise<string | null> => {\n  const stakingContract = getStakingRewardsContract(provider)\n\n  return new Promise((resolve) => {\n    stakingContract.methods\n      .withdraw(unstakeQuantity.toString())\n      .send({ from: account, gas: 200000 })\n      .on('transactionHash', (txId: string) => {\n        if (!txId) resolve(null)\n\n        resolve(txId)\n      })\n      .on('error', (error: any) => {\n        console.log(error)\n        resolve(null)\n      })\n  })\n}\n\nexport const getEarnedIndexTokenQuantity = async (\n  provider: provider,\n  account: string\n): Promise<string> => {\n  const stakingContract = getStakingRewardsContract(provider)\n\n  try {\n    const earnedTokenQuantity: string = stakingContract.methods\n      .earned(account)\n      .call()\n\n    return earnedTokenQuantity\n  } catch (e) {\n    console.log(e)\n\n    return '0'\n  }\n}\n\nexport const claimEarnedIndexReward = (\n  provider: provider,\n  account: string\n): Promise<string | null> => {\n  const stakingContract = getStakingRewardsContract(provider)\n\n  return new Promise((resolve) => {\n    stakingContract.methods\n      .getReward()\n      .send({ from: account, gas: 200000 })\n      .on('transactionHash', (txId: string) => {\n        if (!txId) resolve(null)\n\n        resolve(txId)\n      })\n      .on('error', (error: any) => {\n        console.log(error)\n        resolve(null)\n      })\n  })\n}\n\nexport const unstakeAndClaimEarnedIndexReward = (\n  provider: provider,\n  account: string\n): Promise<string | null> => {\n  const stakingContract = getStakingRewardsContract(provider)\n\n  return new Promise((resolve) => {\n    stakingContract.methods\n      .exit()\n      .send({ from: account, gas: 250000 })\n      .on('transactionHash', (txId: string) => {\n        if (!txId) resolve(null)\n\n        resolve(txId)\n      })\n      .on('error', (error: any) => {\n        console.log(error)\n        resolve(null)\n      })\n  })\n}\n\nexport const getAmountOfStakedTokens = async (\n  provider: provider,\n  contractAddress: string\n) => {\n  const web3 = new Web3(provider)\n  const contract = new web3.eth.Contract(\n    StakeABI as unknown as AbiItem,\n    contractAddress\n  )\n  return await contract.methods.totalSupply().call()\n}\n\nexport const getRewardsForDuration = async (\n  provider: provider\n): Promise<BigNumber> => {\n  const stakingContract = getStakingRewardsContract(provider)\n  const rewardForDuration = await stakingContract.methods\n    .getRewardForDuration()\n    .call()\n\n  return new BigNumber(rewardForDuration)\n}\n\nexport const getTotalSupply = async (\n  provider: provider\n): Promise<BigNumber> => {\n  const stakingContract = getStakingRewardsContract(provider)\n  const totalSupply = await stakingContract.methods.totalSupply().call()\n  return new BigNumber(totalSupply)\n}\n\n// Currently set for 12pm PST Dec. 6th\nexport const farmEndTime = '1646542800'\n"]},"metadata":{},"sourceType":"module"}