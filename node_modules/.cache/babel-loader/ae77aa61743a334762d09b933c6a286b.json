{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport { useCallback, useEffect, useState } from 'react';\nimport { minimumRequiredApprovalQuantity } from 'constants/approvals';\nimport useWallet from 'hooks/useWallet';\nimport { approve } from 'utils';\nimport useAllowance from './useAllowance';\n\nconst useApproval = (tokenAddress, spenderAddress, onTxHash) => {\n  _s();\n\n  const allowance = useAllowance(tokenAddress, spenderAddress);\n  const [isApproving, setIsApproving] = useState(false);\n  const [isApproved, setIsApproved] = useState(false);\n  const {\n    account,\n    ethereum\n  } = useWallet();\n  const handleApprove = useCallback(async () => {\n    if (!ethereum || !account || !spenderAddress || !tokenAddress) {\n      return;\n    }\n\n    try {\n      setIsApproving(true);\n      const result = await approve(account, spenderAddress, tokenAddress, ethereum, onTxHash);\n      setIsApproved(result);\n      setIsApproving(false);\n    } catch (e) {\n      setIsApproving(false);\n      return false;\n    }\n  }, [account, ethereum, onTxHash, setIsApproved, setIsApproving, spenderAddress, tokenAddress]);\n  useEffect(() => {\n    if (allowance === null || allowance === void 0 ? void 0 : allowance.isGreaterThan(minimumRequiredApprovalQuantity)) {\n      setIsApproved(true);\n      return;\n    }\n\n    setIsApproved(false);\n  }, [allowance, setIsApproved]);\n  return {\n    isApproved,\n    isApproving,\n    onApprove: handleApprove\n  };\n};\n\n_s(useApproval, \"jET7EugAFm4x9rv2ZXXeaZwvMEY=\", false, function () {\n  return [useAllowance, useWallet];\n});\n\nexport default useApproval;","map":{"version":3,"sources":["/Users/safahi/Desktop/index-ui-master/src/hooks/useApproval.ts"],"names":["useCallback","useEffect","useState","minimumRequiredApprovalQuantity","useWallet","approve","useAllowance","useApproval","tokenAddress","spenderAddress","onTxHash","allowance","isApproving","setIsApproving","isApproved","setIsApproved","account","ethereum","handleApprove","result","e","isGreaterThan","onApprove"],"mappings":";;AAAA,SAASA,WAAT,EAAsBC,SAAtB,EAAiCC,QAAjC,QAAiD,OAAjD;AAIA,SAASC,+BAAT,QAAgD,qBAAhD;AACA,OAAOC,SAAP,MAAsB,iBAAtB;AACA,SAASC,OAAT,QAAwB,OAAxB;AAEA,OAAOC,YAAP,MAAyB,gBAAzB;;AAEA,MAAMC,WAAW,GAAG,CAClBC,YADkB,EAElBC,cAFkB,EAGlBC,QAHkB,KAIf;AAAA;;AACH,QAAMC,SAAS,GAAGL,YAAY,CAACE,YAAD,EAAeC,cAAf,CAA9B;AACA,QAAM,CAACG,WAAD,EAAcC,cAAd,IAAgCX,QAAQ,CAAC,KAAD,CAA9C;AACA,QAAM,CAACY,UAAD,EAAaC,aAAb,IAA8Bb,QAAQ,CAAC,KAAD,CAA5C;AAEA,QAAM;AACJc,IAAAA,OADI;AAEJC,IAAAA;AAFI,MAG2Db,SAAS,EAH1E;AAKA,QAAMc,aAAa,GAAGlB,WAAW,CAAC,YAAY;AAC5C,QAAI,CAACiB,QAAD,IAAa,CAACD,OAAd,IAAyB,CAACP,cAA1B,IAA4C,CAACD,YAAjD,EAA+D;AAC7D;AACD;;AACD,QAAI;AACFK,MAAAA,cAAc,CAAC,IAAD,CAAd;AACA,YAAMM,MAAM,GAAG,MAAMd,OAAO,CAC1BW,OAD0B,EAE1BP,cAF0B,EAG1BD,YAH0B,EAI1BS,QAJ0B,EAK1BP,QAL0B,CAA5B;AAOAK,MAAAA,aAAa,CAACI,MAAD,CAAb;AACAN,MAAAA,cAAc,CAAC,KAAD,CAAd;AACD,KAXD,CAWE,OAAOO,CAAP,EAAU;AACVP,MAAAA,cAAc,CAAC,KAAD,CAAd;AACA,aAAO,KAAP;AACD;AACF,GAnBgC,EAmB9B,CACDG,OADC,EAEDC,QAFC,EAGDP,QAHC,EAIDK,aAJC,EAKDF,cALC,EAMDJ,cANC,EAODD,YAPC,CAnB8B,CAAjC;AA6BAP,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIU,SAAJ,aAAIA,SAAJ,uBAAIA,SAAS,CAAEU,aAAX,CAAyBlB,+BAAzB,CAAJ,EAA+D;AAC7DY,MAAAA,aAAa,CAAC,IAAD,CAAb;AACA;AACD;;AAEDA,IAAAA,aAAa,CAAC,KAAD,CAAb;AACD,GAPQ,EAON,CAACJ,SAAD,EAAYI,aAAZ,CAPM,CAAT;AASA,SAAO;AACLD,IAAAA,UADK;AAELF,IAAAA,WAFK;AAGLU,IAAAA,SAAS,EAAEJ;AAHN,GAAP;AAKD,CAzDD;;GAAMX,W;UAKcD,Y,EAO+CF,S;;;AA+CnE,eAAeG,WAAf","sourcesContent":["import { useCallback, useEffect, useState } from 'react'\n\nimport { provider } from 'web3-core'\n\nimport { minimumRequiredApprovalQuantity } from 'constants/approvals'\nimport useWallet from 'hooks/useWallet'\nimport { approve } from 'utils'\n\nimport useAllowance from './useAllowance'\n\nconst useApproval = (\n  tokenAddress?: string,\n  spenderAddress?: string,\n  onTxHash?: (txHash: string) => void\n) => {\n  const allowance = useAllowance(tokenAddress, spenderAddress)\n  const [isApproving, setIsApproving] = useState(false)\n  const [isApproved, setIsApproved] = useState(false)\n\n  const {\n    account,\n    ethereum,\n  }: { account: string | null | undefined; ethereum?: provider } = useWallet()\n\n  const handleApprove = useCallback(async () => {\n    if (!ethereum || !account || !spenderAddress || !tokenAddress) {\n      return\n    }\n    try {\n      setIsApproving(true)\n      const result = await approve(\n        account,\n        spenderAddress,\n        tokenAddress,\n        ethereum,\n        onTxHash\n      )\n      setIsApproved(result)\n      setIsApproving(false)\n    } catch (e) {\n      setIsApproving(false)\n      return false\n    }\n  }, [\n    account,\n    ethereum,\n    onTxHash,\n    setIsApproved,\n    setIsApproving,\n    spenderAddress,\n    tokenAddress,\n  ])\n\n  useEffect(() => {\n    if (allowance?.isGreaterThan(minimumRequiredApprovalQuantity)) {\n      setIsApproved(true)\n      return\n    }\n\n    setIsApproved(false)\n  }, [allowance, setIsApproved])\n\n  return {\n    isApproved,\n    isApproving,\n    onApprove: handleApprove,\n  }\n}\n\nexport default useApproval\n"]},"metadata":{},"sourceType":"module"}